<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>장바구니 - Memory Treasures</title>
    <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- 헤더 -->
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-icon">🏪</span>
                    <h1><a href="index.html">Memory Treasures</a></h1>
                </div>
                
                <nav class="main-nav">
                    <a href="index.html" class="nav-link">홈</a>
                    <a href="products.html" class="nav-link">상품</a>
                    <a href="memory-simulator.html" class="nav-link">기억 토해내기</a>
                    <a href="cart.html" class="nav-link active">
                        <span class="cart-icon">🛒</span>
                        장바구니 <span id="cart-count" class="cart-count">0</span>
                    </a>
                </nav>
                
                <div class="user-menu">
                    <div class="user-info" id="userInfo" style="display: none;">
                        <span id="username"></span>
                        <button onclick="logout()" class="logout-btn">로그아웃</button>
                    </div>
                    <div class="auth-buttons" id="authButtons">
                        <a href="login.html" class="btn btn-outline">로그인</a>
                        <a href="register.html" class="btn btn-primary">회원가입</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- 장바구니 메인 -->
    <section class="cart-section">
        <div class="container">
            <div class="cart-header">
                <h1>🛒 나의 기억 장바구니</h1>
                <div class="cart-actions">
                    <button onclick="clearCart()" class="btn btn-outline btn-small">
                        전체 비우기
                    </button>
                    <button onclick="continuesShopping()" class="btn btn-secondary btn-small">
                        쇼핑 계속하기
                    </button>
                </div>
            </div>
            
            <!-- 장바구니 아이템들 -->
            <div class="cart-content">
                <div class="cart-items" id="cartItems">
                    <!-- JavaScript로 동적 생성 -->
                </div>
                
                <!-- 빈 장바구니 상태 -->
                <div id="emptyCart" class="empty-cart" style="display: none;">
                    <div class="empty-icon">🛒</div>
                    <h3>장바구니가 비어있습니다</h3>
                    <p>소중한 기억들을 담아보세요!</p>
                    <a href="products.html" class="btn btn-primary">
                        기억 구경하러 가기
                    </a>
                </div>
                
                <!-- 장바구니 요약 -->
                <div class="cart-summary" id="cartSummary" style="display: none;">
                    <div class="summary-section">
                        <h3>🧮 주문 요약</h3>
                        
                        <div class="summary-row">
                            <span>상품 금액:</span>
                            <span id="subtotal">0원</span>
                        </div>
                        
                        <div class="summary-row">
                            <span>기억 보관료:</span>
                            <span id="storagefee">3,000원</span>
                        </div>
                        
                        <div class="summary-row">
                            <span>차원 이동비:</span>
                            <span id="shippingFee">5,000원</span>
                        </div>
                        
                        <div class="summary-row discount-row" id="discountRow" style="display: none;">
                            <span>할인 금액:</span>
                            <span id="discountAmount">-0원</span>
                        </div>
                        
                        <div class="summary-divider"></div>
                        
                        <div class="summary-row total-row">
                            <span>총 결제 금액:</span>
                            <span id="totalAmount">0원</span>
                        </div>
                        
                        <!-- 캐릭터 메시지 -->
                        <div class="character-message" id="characterMessage">
                            <div class="message-content">
                                🐱 탱고: "좋은 선택이야! 이 기억들은 정말 특별해!"
                            </div>
                        </div>
                        
                        <!-- 주문 버튼 -->
                        <div class="checkout-actions">
                            <button onclick="proceedToCheckout()" class="btn btn-primary btn-large">
                                <span class="btn-icon">💳</span>
                                주문하기
                            </button>
                        </div>
                        
                        <!-- 할인 쿠폰 -->
                        <div class="coupon-section">
                            <h4>🎫 할인 쿠폰</h4>
                            <div class="coupon-input">
                                <input type="text" id="couponCode" placeholder="쿠폰 코드를 입력하세요">
                                <button onclick="applyCoupon()" class="btn btn-outline btn-small">
                                    적용
                                </button>
                            </div>
                            
                            <div class="available-coupons">
                                <span class="coupon-hint">사용 가능한 쿠폰:</span>
                                <div class="coupon-tags">
                                    <span class="coupon-tag" onclick="applyCouponCode('NURYEONG10')">
                                        NURYEONG10 (10% 할인)
                                    </span>
                                    <span class="coupon-tag" onclick="applyCouponCode('FIRST')">
                                        FIRST (첫 구매 5,000원 할인)
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 추천 상품 섹션 -->
    <section class="recommended-section" id="recommendedSection" style="display: none;">
        <div class="container">
            <h3>💡 함께 구매하면 좋을 기억들</h3>
            <div class="recommended-products" id="recommendedProducts">
                <!-- JavaScript로 동적 생성 -->
            </div>
        </div>
    </section>

    <!-- 삭제 확인 모달 -->
    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>🗑️ 삭제 확인</h3>
            </div>
            <div class="modal-body">
                <p>이 소중한 기억을 장바구니에서 제거하시겠어요?</p>
                <div class="character-reaction">
                    <span id="deleteCharacterReaction"></span>
                </div>
            </div>
            <div class="modal-actions">
                <button onclick="confirmDelete()" class="btn btn-danger">
                    네, 제거할게요
                </button>
                <button onclick="cancelDelete()" class="btn btn-outline">
                    취소
                </button>
            </div>
        </div>
    </div>

    <!-- 알림 토스트 -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="js/memory-treasures.js"></script>
    <script src="js/cart.js"></script>
    <script>
        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', function() {
            checkUserLogin();
            loadCartItems();
            loadRecommendedProducts();
        });
    </script>
</body>
</html>